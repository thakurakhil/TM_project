Illinois has banned the sale of many common kinds of semiautomatic guns with immediate effect in response to a massacre at an Independence Day parade in Highland Park last year and other mass shootings.